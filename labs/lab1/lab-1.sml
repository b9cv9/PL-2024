(****************************************************************************** 
  Шаблон для выполнения заданий лабораторной работы №1

  НЕ СЛЕДУЕТ УДАЛЯТЬ ИЛИ ПЕРЕСТАВЛЯТЬ МЕСТАМИ ЭЛЕМЕНТЫ, 
  ПРЕДСТАВЛЕННЫЕ В ШАБЛОНЕ (ВКЛЮЧАЯ КОММЕНТАРИИ). 
  ЭЛЕМЕНТЫ РЕШЕНИЯ СЛЕДУЕТ ВПИСЫВАТЬ В ПРОМЕЖУТКИ,
  ОПРЕДЕЛЕННЫЕ КОММЕНТАРИЯМИ.
 ******************************************************************************)

(****************************************************************************** 
  Загрузка определений модулей MyDate и Fixed и вспомогательных списков данных 
 ******************************************************************************)
use "lab-1-use.sml";

(****************************************************************************** 
  Задание 1 isLeapYear
 ******************************************************************************)
fun isLeapYear (year : int, isJulian : bool) : bool =
  if isJulian then year mod 4 = 0
  else (year mod 400 = 0)
  orelse (year mod 100 <> 0 andalso year mod 4 = 0)

(******************************************************************************)

(****************************************************************************** 
  Задание 2 isLongMonth
 ******************************************************************************)
fun isLongMonth (month : int) : bool =
  if month < 8 then (month + 1) mod 2 = 0
  else month mod 2 = 0

(******************************************************************************)

(****************************************************************************** 
  Задание 3 daysInMonth
 ******************************************************************************)
fun daysInMonth (d : date, isJulian : bool) : int =
  if (#2 d = 2 andalso isLeapYear(#3 d, isJulian)) 
  then 29
  else if #2 d = 2 
  then 28
  else if isLongMonth (#2 d)
  then 31
  else 30

(******************************************************************************)

(****************************************************************************** 
  Задание 4 isDayOK
 ******************************************************************************)
fun isDayOK (d : date, isJulian : bool) : bool =
  not (#1 d < 1 orelse #1 d > daysInMonth(d, isJulian))

(******************************************************************************)

(****************************************************************************** 
  Задание 5 isMonthOK
 ******************************************************************************)
fun isMonthOK (d : date) : bool =
  not (#2 d < 1 orelse #2 d > 12)

(******************************************************************************)

(****************************************************************************** 
  Задание 6 isCorrectDate
 ******************************************************************************)
fun isCorrectDate (d : date, isJulian : bool) : bool =
  isDayOK(d, isJulian) andalso isMonthOK(d)
(******************************************************************************)

(****************************************************************************** 
  Задание 7 incDateByNum
 ******************************************************************************)
fun incDateByNum (d : date, days : int, isJulian : bool) : date =
  if #1 d + days <= daysInMonth (d, isJulian)
  then MyDate.anotherDay(d, #1 d + days) 
  else if #2 d < 12 
  then incDateByNum( (1, #2 d + 1, #3 d)
                   , days - daysInMonth(d, isJulian) + #1 d - 1
                   , isJulian
                   )
  else incDateByNum( (1, 1, #3 d + 1)
                   , days - daysInMonth(d, isJulian) + #1 d - 1
                   , isJulian
                   )

(******************************************************************************)

(****************************************************************************** 
  Задание 8 decDateByNum
 ******************************************************************************)
fun decDateByNum (d : date, days : int, isJulian : bool) : date =
  if #1 d - days > 0
  then MyDate.anotherDay(d, #1 d - days) 
  else if #2 d > 1 
  then decDateByNum( (daysInMonth((#1 d, #2 d - 1, #3 d), isJulian)
                     , #2 d - 1
                     , #3 d
                     )
                   , days - #1 d
                   , isJulian
                   )
  else decDateByNum( (31, 12, #3 d - 1)
                   , days - #1 d
                   , isJulian
                   )

(******************************************************************************)

(****************************************************************************** 
  Задание 9 newStyleCorrection
 ******************************************************************************)


(******************************************************************************)

(****************************************************************************** 
  Задание 10 toJulianDay
 ******************************************************************************)


(******************************************************************************)

(****************************************************************************** 
  Задание 11 toGrigorianDay
 ******************************************************************************)


(******************************************************************************)

(****************************************************************************** 
  Задание 12 younger
 ******************************************************************************)


(******************************************************************************)

(****************************************************************************** 
  Задание 13 youngest
 ******************************************************************************)


(******************************************************************************)

(****************************************************************************** 
  Задание 14 getNthFixed
 ******************************************************************************)


(******************************************************************************)

(****************************************************************************** 
  Задание 15 numToDigits
 ******************************************************************************)


(******************************************************************************)

(****************************************************************************** 
  Задание 16 listElements
 ******************************************************************************)


(******************************************************************************)

(****************************************************************************** 
  Задание 17 listSum
 ******************************************************************************)


(******************************************************************************)

(****************************************************************************** 
  Задание 18 maxSmaller
 ******************************************************************************)


(******************************************************************************)

(****************************************************************************** 
  Задание 19 dateToCorrectionNums
 ******************************************************************************)


(******************************************************************************)

(****************************************************************************** 
  Задание 20 firstNewMoon
 ******************************************************************************)


(******************************************************************************)

(****************************************************************************** 
  Задание 21 winterSolstice
 ******************************************************************************)


(******************************************************************************)

(****************************************************************************** 
  Задание 22 chineseNewYearDate
 ******************************************************************************)


(******************************************************************************)

(****************************************************************************** 
  Задание 23 getNthString
 ******************************************************************************)


(******************************************************************************)

(****************************************************************************** 
  Задание 24 dateToString
 ******************************************************************************)


(******************************************************************************)

(****************************************************************************** 
  Задание 25 chineseYear
 ******************************************************************************)


(******************************************************************************)

(****************************************************************************** 
  Задание 26 dateToChineseYear
 ******************************************************************************)


(******************************************************************************)

(****************************************************************************** 
  Задание 27 dateToAnimal
 ******************************************************************************)


(******************************************************************************)

(****************************************************************************** 
  Задание 28 animal
 ******************************************************************************)


(******************************************************************************)

(****************************************************************************** 
  Задание 29 extractAnimal
 ******************************************************************************)


(******************************************************************************)

(****************************************************************************** 
  Задание 30 extractAnimals
 ******************************************************************************)


(******************************************************************************)

(****************************************************************************** 
  Задание 31 youngestFromAnimals
 ******************************************************************************)


(******************************************************************************)

(****************************************************************************** 
  Задание 32 oldStyleStudents
 ******************************************************************************)


(******************************************************************************)

(****************************************************************************** 
  Задание 33 youngestFromOldStyleAnimals
 ******************************************************************************)


(******************************************************************************)

(****************************************************************************** 
  Задание 34 listOfStringDates
 ******************************************************************************)


(******************************************************************************)

(****************************************************************************** 
  Задание 35 oldStyleStudentStringDates
 ******************************************************************************)


(******************************************************************************)

